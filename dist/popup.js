const p=chrome.runtime.getURL("assets/play.png"),h=chrome.runtime.getURL("assets/delete.png"),r="xxxSecretxxx",l=document.getElementById("expCnt"),i=document.createElement("a");i.innerText="Click Here to Download Excel Sheet";l.appendChild(i);l.addEventListener("click",u);function d(){return new Promise(function(e,t){chrome.storage.local.get([r],function(o){e(o[r]||[])})})}async function k(e){await chrome.storage.local.set({[r]:e}),m()}function g(e,t){const o=document.getElementById("bookmarks-list"),n=document.createElement("div"),s=document.createElement("a");s.href=t,s.innerText=e;const c=document.createElement("img");c.src=p,c.style.width="20px",c.style.height="20px",c.addEventListener("click",f);const a=document.createElement("img");a.src=h,a.style.width="20px",a.style.height="20px",a.addEventListener("click",y),n.appendChild(s),n.appendChild(c),n.appendChild(a),n.classList.add("bookmark"),o.appendChild(n)}async function m(){const e=document.getElementById("bookmarks-list");e.innerHTML="",(await d()).forEach(function(o){g(o.title,o.url)})}window.addEventListener("DOMContentLoaded",async function(){m()});function f(){const e=this.previousSibling.href;window.open(e,"_blank")}async function y(){const e=this.previousSibling.previousSibling.href,o=(await d()).filter(function(n){return n.url!==e});await k(o)}const E="546067484138-o5h7nuv4sg2di26qruuc53ijl9uhqal0.apps.googleusercontent.com",b="http://localhost:3000/auth/google/callback",x=`
https://accounts.google.com/o/oauth2/v2/auth?
client_id=${E}&
response_type=code&
redirect_uri=${encodeURIComponent(b)}&
scope=openid%20email%20profile&
access_type=offline&
prompt=consent
`;function w(){window.open(x,"_blank")}async function v(){const e=await chrome.storage.local.get(["token"]);return{email:await chrome.storage.local.get(["email"]),token:e}}async function u(){i.innerText="Fetching ...";const e=await v();chrome.runtime.sendMessage({type:"EXPORT_EXCEL",userData:e},function(t){if(console.log(t.buffer),console.log(t.data),console.log(t.type),t.success===!0){console.log("byteLength:",t.buffer?.byteLength),new Blob([t.buffer],{type:t.type});const o=document.createElement("a");o.href=t.dataUrl,o.download="data.xlsx",document.body.appendChild(o),o.click(),o.remove()}else i.innerText="You have to Login First",l.removeEventListener("click",u),l.addEventListener("click",w)})}

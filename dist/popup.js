const p=chrome.runtime.getURL("assets/play.png"),k=chrome.runtime.getURL("assets/delete.png"),r="xxxSecretxxx",i=document.getElementById("expCnt"),l=document.createElement("a");l.innerText="Click Here to Download Excel Sheet";i.appendChild(l);i.addEventListener("click",u);function d(){return new Promise(function(e,t){chrome.storage.local.get([r],function(n){e(n[r]||[])})})}async function h(e){await chrome.storage.local.set({[r]:e}),m()}function g(e,t){const n=document.getElementById("bookmarks-list"),o=document.createElement("div"),s=document.createElement("a");s.href=t,s.innerText=e;const c=document.createElement("img");c.src=p,c.style.width="20px",c.style.height="20px",c.addEventListener("click",f);const a=document.createElement("img");a.src=k,a.style.width="20px",a.style.height="20px",a.addEventListener("click",y),o.appendChild(s),o.appendChild(c),o.appendChild(a),o.classList.add("bookmark"),n.appendChild(o)}async function m(){const e=document.getElementById("bookmarks-list");e.innerHTML="",(await d()).forEach(function(n){g(n.title,n.url)})}window.addEventListener("DOMContentLoaded",async function(){m()});function f(){const e=this.previousSibling.href;window.open(e,"_blank")}async function y(){const e=this.previousSibling.previousSibling.href,n=(await d()).filter(function(o){return o.url!==e});await h(n)}const E="546067484138-o5h7nuv4sg2di26qruuc53ijl9uhqal0.apps.googleusercontent.com",b="https://queue-overflow-backend.onrender.com/auth/google/callback",w=`
https://accounts.google.com/o/oauth2/v2/auth?
client_id=${E}&
response_type=code&
redirect_uri=${encodeURIComponent(b)}&
scope=openid%20email%20profile&
access_type=offline&
prompt=consent
`;function x(){window.open(w,"_blank")}async function v(){const e=await chrome.storage.local.get(["token"]);return{email:await chrome.storage.local.get(["email"]),token:e}}async function u(){l.innerText=`Fetching ...
Backend is running on free tier
It can take upto 1 minute `;const e=await v();chrome.runtime.sendMessage({type:"EXPORT_EXCEL",userData:e},function(t){if(console.log(t.buffer),console.log(t.data),console.log(t.type),t.success===!0){console.log("byteLength:",t.buffer?.byteLength),new Blob([t.buffer],{type:t.type});const n=document.createElement("a");n.href=t.dataUrl,n.download="data.xlsx",document.body.appendChild(n),n.click(),n.remove()}else l.innerText="You have to Login First",i.removeEventListener("click",u),i.addEventListener("click",x)})}
